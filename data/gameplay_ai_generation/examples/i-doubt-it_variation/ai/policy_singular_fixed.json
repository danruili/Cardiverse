{
    "game_description": "### 1. **Game State**\n\n#### **Common Information:**\n- **Central Pile:** Cards collected from challenges and normal play.\n- **Turn Order:** A dynamic sequence visible to all players, which may change based on player actions, particularly in Phase 3.\n- **Phase Tracker:** Indicates the current phase of the game (Accumulation, Exchange and Alliances, or Gem Collection and Final Moves).\n\n#### **Player-Specific Information:**\n- **Public:**\n  - **Declared Rank:** Last rank announced by each player.\n  - **Exchanged Cards:** Cards publicized during exchanges in Phase 2.\n  - **Gems and Bonuses:** Number of gems and bonuses publicly known for each player, primarily observed in Phase 3.\n- **Private:**\n  - **Player Hand:** Individual cards visible only to the player.\n  - **Suit Diversity:** Count of unique suits in a player\u2019s hand.\n  - **Chance Cards:** Effects activated from the chance card deck, known only to the owning player.\n\n---\n\n### 2. **Card**\n\n#### **Attributes:**\n- **Rank:** One of {A, 2, 3, ..., 10, J, Q, K}.\n- **Suit:** One of {Hearts, Diamonds, Clubs, Spades}.\n- **Special Abilities:** Specific cards provide strategic advantages, like altering turns or shielding challenges.\n\n---\n\n### 3. **Deck and Initial Dealing**\n\n#### **Deck Composition:**\n- A standard 52-card deck intermixes with a deck of chance cards enabling random modifiers.\n\n#### **Initial Dealing:**\n- Cards are evenly distributed among players until depleted, initiating the starting hand for each participant.\n\n---\n\n### 4. **Legal Action Space**\n\n#### **Phase 1: Accumulation**\n1. **Declare and Place Cards:**\n   - Declare a rank and lay 1 to 4 cards face down.\n   - Must be current player's turn based on present sequence.\n2. **Challenge Declaration:**\n   - Challenge the last declared rank by another player with \"I doubt it.\"\n   - Available to the next player in sequence.\n\n#### **Phase 2: Exchange and Alliances**\n1. **Card Exchange:**\n   - Once per game, formally swap two cards with another agreed player.\n   - Both players must consent to proceed.\n2. **Form Alliances:**\n   - Form alliances temporarily for strategic benefits, influencing both parties\u2019 interactions.\n   - Requires agreement amongst involved players.\n\n#### **Phase 3: Gem Collection and Final Moves**\n1. **Collect Gems:**\n   - Leverage gems, earned by diverse suits or actions, for ability activation.\n   - Manifest through Phase 3 actions or bonuses.\n2. **Final Moves:**\n   - Each player concludes by passing one card to the next player on the right.\n\n#### **Special and Adaptive Actions:**\n- Use special chance cards to manipulate order or influence results, especially prevalent during strategic maneuvers in Phase 3.\n\n---\n\n### 5. **Round Sequence**\n\n#### **Contact of Play:**\n1. **Phase 1: Accumulation**\n   - Proceed clockwise in usual card placing, following sequence from Aces to Kings.\n2. **Phase 2: Exchange and Alliances**\n   - Execute exchanges and alliance formations explicitly detailed through player interactions.\n3. **Phase 3: Gem Collection and Adaptive Moves**\n   - Collect gems, enact special abilities, adapt turn orders, and accomplish final hand structuring.\n\n#### **Winning Conditions:**\n- At the close, evaluation hinges primarily on suit diversity, supplemented by strategic gem use and bonus achievements.\n\n---\n\n### 6. **Additional Mechanics & Rules**\n\n- **Chance Cards:** These bring in random elements affecting the trajectory of play\u2014clarified at the point of draw or effect activation.\n- **Turn Order Dynamicity:** Phase 3 explicitly incorporates decisions that can realign player order to optimize endgame interactions.\n\n---\n\n### 7. **Player Observation Information**\n\n#### **Visible to All Players:**\n- Cards challenged and revealed during disputes.\n- Publicly declared numbers of gems held.\n- Established alliances, known turn sequence changes during gameplay.\n\n#### **Hidden Information:**\n- Personal hands, chance card effects known or chosen by players, influencing player-specific strategy without revealing intents to others.\n\n---\n\n### 8. **Endgame Scoring**\n\n##### **Scoring Metrics:**\n- **Suit Diversity:** Number of unique suits establishes core competitiveness.\n- **Gems and Bonuses:** Added value through gems and bonuses enhances player capabilities and scoring flexibility.\n- Decision-making, card management, and strategy adaptability define the winner, with ties resolved through a concise, final assessment or shared victory.\n\nThis refined description provides clearer paths for gameplay transition through phases, explicitly delineates objectives, and aligns strategies with the game\u2019s dynamic interactions.",
    "input_description": "Example: \n{\"common\": {\"num_players\": 4, \"current_player\": 2, \"central_pile\": [{\"rank\": \"10\", \"suit\": \"Hearts\", \"type\": \"standard\"}, {\"type\": \"chance\"}, {\"rank\": \"4\", \"suit\": \"Spades\", \"type\": \"standard\"}, {\"rank\": \"9\", \"suit\": \"Hearts\", \"type\": \"standard\"}, {\"rank\": \"10\", \"suit\": \"Spades\", \"type\": \"standard\"}, {\"rank\": \"A\", \"suit\": \"Diamonds\", \"type\": \"standard\"}, {\"rank\": \"4\", \"suit\": \"Hearts\", \"type\": \"standard\"}, {\"type\": \"chance\"}, {\"rank\": \"8\", \"suit\": \"Diamonds\", \"type\": \"standard\"}, {\"rank\": \"4\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"9\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"7\", \"suit\": \"Spades\", \"type\": \"standard\"}, {\"rank\": \"3\", \"suit\": \"Diamonds\", \"type\": \"standard\"}, {\"rank\": \"K\", \"suit\": \"Spades\", \"type\": \"standard\"}, {\"rank\": \"6\", \"suit\": \"Diamonds\", \"type\": \"standard\"}, {\"rank\": \"7\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"type\": \"chance\"}], \"turn_order\": [0, 1, 2, 3], \"phase_tracker\": \"Accumulation\", \"is_over\": false, \"winner\": null, \"facedown_cards\": {\"deck_size\": 0}, \"faceup_cards\": {\"challenges\": [], \"alliances\": [], \"gem_collections\": []}}, \"players\": [{\"public\": {\"declared_rank\": null, \"exchanged_cards\": [], \"gems\": 0, \"bonuses\": 0}, \"faceup_cards\": {\"collected_cards\": []}}, {\"public\": {\"declared_rank\": null, \"exchanged_cards\": [], \"gems\": 0, \"bonuses\": 0}, \"faceup_cards\": {\"collected_cards\": []}}, {\"public\": {\"declared_rank\": null, \"exchanged_cards\": [], \"gems\": 0, \"bonuses\": 0, \"current_player\": true}, \"private\": {\"hand\": [{\"rank\": \"2\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"3\", \"suit\": \"Hearts\", \"type\": \"standard\"}, {\"rank\": \"8\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"10\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"3\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"2\", \"suit\": \"Spades\", \"type\": \"standard\"}, {\"rank\": \"K\", \"suit\": \"Hearts\", \"type\": \"standard\"}, {\"rank\": \"K\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"type\": \"chance\"}, {\"rank\": \"6\", \"suit\": \"Clubs\", \"type\": \"standard\"}, {\"rank\": \"9\", \"suit\": \"Spades\", \"type\": \"standard\"}], \"suit_diversity\": 4, \"chance_cards\": [], \"exchange_used\": false}, \"faceup_cards\": {\"collected_cards\": []}}, {\"public\": {\"declared_rank\": null, \"exchanged_cards\": [], \"gems\": 0, \"bonuses\": 0}, \"faceup_cards\": {\"collected_cards\": []}}], \"recent_history\": [{\"type\": \"action\", \"player_id\": 2, \"action\": {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"K\", \"num_cards\": 4}, \"id\": 23}, \"msg\": \"Player 2 decides to: declare_and_place-(rank: K, num_cards: 4)\"}, {\"type\": \"info\", \"msg\": \"Player 2 declares rank K and places 4 cards.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 2, \"msg\": \"---------- End of Player 2's turn ----------\"}, {\"type\": \"action\", \"player_id\": 3, \"action\": {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"Q\", \"num_cards\": 3}, \"id\": 34}, \"msg\": \"Player 3 decides to: declare_and_place-(rank: Q, num_cards: 3)\"}, {\"type\": \"info\", \"msg\": \"Player 3 declares rank Q and places 3 cards.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 3, \"msg\": \"---------- End of Player 3's turn ----------\"}, {\"type\": \"action\", \"player_id\": 0, \"action\": {\"action\": \"declare_and_place\", \"args\": {\"rank\": null, \"num_cards\": 3}, \"id\": 2}, \"msg\": \"Player 0 decides to: declare_and_place-(rank: None, num_cards: 3)\"}, {\"type\": \"info\", \"msg\": \"Player 0 declares rank None and places 3 cards.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 0, \"msg\": \"---------- End of Player 0's turn ----------\"}, {\"type\": \"action\", \"player_id\": 1, \"action\": {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"6\", \"num_cards\": 4}, \"id\": 27}, \"msg\": \"Player 1 decides to: declare_and_place-(rank: 6, num_cards: 4)\"}, {\"type\": \"info\", \"msg\": \"Player 1 declares rank 6 and places 4 cards.\", \"role\": null}], \"legal_actions\": [{\"action\": \"declare_and_place\", \"args\": {\"rank\": null, \"num_cards\": 1}, \"id\": 0}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": null, \"num_cards\": 2}, \"id\": 1}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": null, \"num_cards\": 3}, \"id\": 2}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": null, \"num_cards\": 4}, \"id\": 3}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"8\", \"num_cards\": 1}, \"id\": 4}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"8\", \"num_cards\": 2}, \"id\": 5}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"8\", \"num_cards\": 3}, \"id\": 6}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"8\", \"num_cards\": 4}, \"id\": 7}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"10\", \"num_cards\": 1}, \"id\": 8}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"10\", \"num_cards\": 2}, \"id\": 9}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"10\", \"num_cards\": 3}, \"id\": 10}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"10\", \"num_cards\": 4}, \"id\": 11}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"3\", \"num_cards\": 1}, \"id\": 12}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"3\", \"num_cards\": 2}, \"id\": 13}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"3\", \"num_cards\": 3}, \"id\": 14}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"3\", \"num_cards\": 4}, \"id\": 15}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"K\", \"num_cards\": 1}, \"id\": 16}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"K\", \"num_cards\": 2}, \"id\": 17}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"K\", \"num_cards\": 3}, \"id\": 18}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"K\", \"num_cards\": 4}, \"id\": 19}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"2\", \"num_cards\": 1}, \"id\": 20}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"2\", \"num_cards\": 2}, \"id\": 21}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"2\", \"num_cards\": 3}, \"id\": 22}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"2\", \"num_cards\": 4}, \"id\": 23}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"6\", \"num_cards\": 1}, \"id\": 24}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"6\", \"num_cards\": 2}, \"id\": 25}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"6\", \"num_cards\": 3}, \"id\": 26}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"6\", \"num_cards\": 4}, \"id\": 27}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"9\", \"num_cards\": 1}, \"id\": 28}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"9\", \"num_cards\": 2}, \"id\": 29}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"9\", \"num_cards\": 3}, \"id\": 30}, {\"action\": \"declare_and_place\", \"args\": {\"rank\": \"9\", \"num_cards\": 4}, \"id\": 31}]}\n\nExplanation: \n{\"common\": {\"num_players\": \"The number of players in the game. In this case, it is 4.\", \"current_player\": \"The index of the player currently taking their turn. This is Player 2.\", \"central_pile\": \"A list of cards (standard or chance) that are currently in the central area of the game. Each card has attributes like 'rank', 'suit', and 'type'.\", \"turn_order\": \"A list representing the order in which players take turns. The players are indexed from 0 to 3.\", \"phase_tracker\": \"A string indicating the current phase of the game, which guides the actions available to players. In this snapshot, it is 'Accumulation'.\", \"is_over\": \"A boolean that indicates whether the game has concluded. Currently, it is false, which means the game is ongoing.\", \"winner\": \"If the game is over, this field would contain the index of the winning player. It is null because the game is not over.\", \"facedown_cards\": {\"deck_size\": \"The number of cards remaining in the deck. In this state, it is 0 indicating the deck is depleted.\"}, \"faceup_cards\": {\"challenges\": \"A list of challenges that have been made in the game. Currently empty.\", \"alliances\": \"A list of alliances formed between players in the game. Currently empty.\", \"gem_collections\": \"A list of gem collection events in the game. Currently empty.\"}}, \"players\": [{\"public\": {\"declared_rank\": \"The current declared rank of cards by the player if they have made such a declaration. It is null for all players currently.\", \"exchanged_cards\": \"A list of cards that this player has exchanged with others. It is empty as no exchanges have been made.\", \"gems\": \"The number of gems collected by the player which contributes to their score. All players currently have 0 gems.\", \"bonuses\": \"The number of bonus points accumulated by the player which contributes to their score. All players currently have 0 bonuses.\"}, \"faceup_cards\": {\"collected_cards\": \"A list of cards that a player has collected and placed face up, though currently empty for all players.\"}}, {\"private\": {\"hand\": \"A list of cards in the player's hand, known only to that player. Each card has attributes like 'rank', 'suit', and 'type'.\", \"suit_diversity\": \"An integer representing the number of different suits present in the player's hand. Player 2 has a suit diversity of 4.\", \"chance_cards\": \"A list of chance cards the player holds, though currently empty for Player 2.\", \"exchange_used\": \"A boolean indicating if the player has used their exchange action this phase. Player 2 has false, meaning no exchange used yet.\"}}], \"recent_history\": [\"A list of recent actions and events in the game, such as player actions, info messages, and turn ends. Each entry provides details such as player_id, action details, and messages.\"], \"legal_actions\": [\"A list of actions that the current player (Player 2) is legally allowed to take on their turn. Each action includes the type, arguments needed, and an identifier.\"]}",
    "policy_list": [
        "**Suit Diversity Maximization**\nThroughout the game, focus on maintaining a hand with the maximum possible diversity of suits. In Phase 1, strategically place cards face down to mislead opponents and protect suit diversity. If necessary, use deception to avoid losing cards of unique suits. During Phase 2, form alliances or exchange to acquire missing suits. In Phase 3, collect gems by showcasing your suit diversity and use chance cards to optimize your turn order for the final pass."
    ],
    "code": [
        "\ndef score(state: dict, action: dict) -> float:\n    import numpy as np\n\n    def calculate_suit_diversity_bonus(hand):\n        suits = set(card['suit'] for card in hand if card.get('suit'))\n        return len(suits)\n\n    def calculate_public_gems_bonus(player):\n        return player['public']['gems']\n\n    def calculate_hand_strength(hand):\n        # Dummy hand strength calculation\n        rank_values = {'A': 14, 'K': 13, 'Q': 12, 'J': 11}\n        rank_values.update({str(i): i for i in range(2, 11)})\n        return np.sum([rank_values.get(card['rank'], 0) for card in hand if card.get('rank') and card['type'] == 'standard'])\n\n    current_player_index = state['common']['current_player']\n    current_player = state['players'][current_player_index]\n\n    # Initial score based on suit diversity, which fits the policy.\n    initial_score = calculate_suit_diversity_bonus(current_player['private']['hand'])\n\n    # Add bonuses for publicly known gems.\n    public_gem_bonus = calculate_public_gems_bonus(current_player)\n\n    # Calculate hand strength as an additional factor.\n    hand_strength = calculate_hand_strength(current_player['private']['hand'])\n\n    # Action-based modifiers\n    action_multiplier = 0\n\n    if action['action'] == 'declare_and_place':\n        # Strategy to retain diversity and make a plausible declaration.\n        num_cards = action['args']['num_cards']\n        declared_rank = action['args'].get('rank')  # Use get to avoid KeyError\n        hand_ranks = [card['rank'] for card in current_player['private']['hand'] if card.get('rank')]\n\n        # Check plausibility of declaring a rank from hand (more convincing)\n        plausible_declaration_bonus = declared_rank is not None and hand_ranks.count(declared_rank) >= num_cards\n\n        # Use action context for scoring\n        if plausible_declaration_bonus:\n            action_multiplier = 1.5\n        else:\n            action_multiplier = 0.5\n\n    # Assemble score\n    result_score = (initial_score * 0.4 +\n                    public_gem_bonus * 0.3 +\n                    hand_strength * 0.1) * action_multiplier\n\n    # Normalize score to 0-1\n    max_possible_score = (13 * 0.4 + 4 * 0.3 + 130 * 0.1) * 1.5\n    if max_possible_score == 0:\n        return 0\n    result_score = result_score / max_possible_score\n\n    return np.clip(result_score, 0, 1)\n"
    ]
}