{
    "game_description": "Go Fish is a fun game that will amuse and entertain even the youngest card players. It is similar to the game Authors.\n\n### The Pack\n\nThe standard 52-card pack is used. Some cards will be dealt and the rest will form the stock pile.\n\nShop our Hoyle 6 in 1 Fun Pack\n\n### Object of the Game\n\nThe goal is to win the most \"books\" of cards. A book is any four of a kind, such as four kings, four aces, and so on.\n\n### Rank of Cards\n\nThe cards rank from ace (high) to two (low). The suits are not important, only the card numbers are relevant, such as two 3s, two 10s, and so on.\n\n### The Deal\n\nAny player deals one card face up to each player. The player with the lowest card is the dealer. The dealer shuffles the cards, and the player to the right cuts them.\n\nThe dealer completes the cut and deals the cards clockwise one at a time, face down, beginning with the player to the left. If two or three people are playing, each player receives seven cards. If four or five people are playing, each receives five cards. The remainder of the pack is placed face down on the table to form the stock.\n\n### The Play\n\nThe player to the left of the dealer looks directly at any opponent and says, for example, \"Give me your kings,\" usually addressing the opponent by name and specifying the rank that they want, from ace down to two. The player who is \"fishing \u201cmust have at least one card of the rank that was asked for in their hand. The player who is addressed must hand over all the cards requested. If the player has none, they say, \"Go fish!\" and the player who made the request draws the top card of the stock and places it in their hand.\n\nIf a player gets one or more cards of the named rank that was asked for, they are entitled to ask the same or another player for a card. The player can ask for the same card or a different one. So long as the player succeeds in getting cards (makes a catch), their turn continues. When a player makes a catch, they must reveal the card so that the catch is verified. If a player gets the fourth card of a book, the player shows all four cards, places them on the table face up in front of everyone, and plays again.\n\nIf the player goes fishing without \"making a catch\" (does not receive a card he asked for), the turn passes to the left.\n\nThe game ends when all thirteen books have been won. The winner is the player with the most books. During the game, if a player is left without cards, they may (when it's their turn to play), draw from the stock and then ask for cards of that rank. If there are no cards left in the stock, they are out of the game.",
    "input_description": "Example: \n{\"common\": {\"num_players\": 4, \"current_player\": 0, \"winner\": null, \"is_over\": false, \"books\": [0, 0, 0, 0], \"facedown_cards\": {\"stock_size\": 28}}, \"players\": [{\"public\": {\"current_player\": true}, \"facedown_cards\": {\"hand\": [{\"rank\": \"Q\"}, {\"rank\": \"Q\"}, {\"rank\": \"8\"}, {\"rank\": \"Q\"}]}, \"faceup_cards\": {\"books\": []}}, {\"public\": {}, \"facedown_cards\": {\"hand_size\": 7}, \"faceup_cards\": {\"books\": []}}, {\"public\": {}, \"facedown_cards\": {\"hand_size\": 7}, \"faceup_cards\": {\"books\": []}}, {\"public\": {}, \"facedown_cards\": {\"hand_size\": 6}, \"faceup_cards\": {\"books\": []}}], \"recent_history\": [{\"type\": \"action\", \"player_id\": 0, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 3, \"rank\": \"Q\"}}, \"msg\": \"Player 0 decides to: request-(target_player: 3, rank: Q)\"}, {\"type\": \"info\", \"msg\": \"Player 0 takes an action: {'action': 'request', 'args': {'target_player': 3, 'rank': 'Q'}}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 requests rank Q from Player 3.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 3 says 'Go Fish!'.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 draws 3 from stock.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Next player is Player 1.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 0, \"msg\": \"---------- End of Player 0's turn ----------\"}, {\"type\": \"action\", \"player_id\": 1, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 0, \"rank\": \"3\"}, \"id\": 2}, \"msg\": \"Player 1 decides to: request-(target_player: 0, rank: 3)\"}, {\"type\": \"info\", \"msg\": \"Player 1 takes an action: {'action': 'request', 'args': {'target_player': 0, 'rank': '3'}, 'id': 2}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 1 requests rank 3 from Player 0.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 gives 1 card(s) to Player 1.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 1, \"msg\": \"---------- End of Player 1's turn ----------\"}, {\"type\": \"action\", \"player_id\": 1, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 0, \"rank\": \"9\"}, \"id\": 3}, \"msg\": \"Player 1 decides to: request-(target_player: 0, rank: 9)\"}, {\"type\": \"info\", \"msg\": \"Player 1 takes an action: {'action': 'request', 'args': {'target_player': 0, 'rank': '9'}, 'id': 3}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 1 requests rank 9 from Player 0.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 says 'Go Fish!'.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 1 draws 4 from stock.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Next player is Player 2.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 1, \"msg\": \"---------- End of Player 1's turn ----------\"}, {\"type\": \"action\", \"player_id\": 2, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 0, \"rank\": \"K\"}, \"id\": 0}, \"msg\": \"Player 2 decides to: request-(target_player: 0, rank: K)\"}, {\"type\": \"info\", \"msg\": \"Player 2 takes an action: {'action': 'request', 'args': {'target_player': 0, 'rank': 'K'}, 'id': 0}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 2 requests rank K from Player 0.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 gives 1 card(s) to Player 2.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 2, \"msg\": \"---------- End of Player 2's turn ----------\"}, {\"type\": \"action\", \"player_id\": 2, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 0, \"rank\": \"7\"}, \"id\": 2}, \"msg\": \"Player 2 decides to: request-(target_player: 0, rank: 7)\"}, {\"type\": \"info\", \"msg\": \"Player 2 takes an action: {'action': 'request', 'args': {'target_player': 0, 'rank': '7'}, 'id': 2}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 2 requests rank 7 from Player 0.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 0 says 'Go Fish!'.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 2 draws 6 from stock.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Next player is Player 3.\", \"role\": null}, {\"type\": \"turn_end\", \"player_id\": 2, \"msg\": \"---------- End of Player 2's turn ----------\"}, {\"type\": \"action\", \"player_id\": 3, \"action\": {\"action\": \"request\", \"args\": {\"target_player\": 1, \"rank\": \"5\"}, \"id\": 9}, \"msg\": \"Player 3 decides to: request-(target_player: 1, rank: 5)\"}, {\"type\": \"info\", \"msg\": \"Player 3 takes an action: {'action': 'request', 'args': {'target_player': 1, 'rank': '5'}, 'id': 9}\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 3 requests rank 5 from Player 1.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 1 says 'Go Fish!'.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Player 3 draws 8 from stock.\", \"role\": null}, {\"type\": \"info\", \"msg\": \"Next player is Player 0.\", \"role\": null}], \"legal_actions\": [{\"action\": \"request\", \"args\": {\"target_player\": 1, \"rank\": \"Q\"}, \"id\": 0}, {\"action\": \"request\", \"args\": {\"target_player\": 1, \"rank\": \"8\"}, \"id\": 1}, {\"action\": \"request\", \"args\": {\"target_player\": 2, \"rank\": \"Q\"}, \"id\": 2}, {\"action\": \"request\", \"args\": {\"target_player\": 2, \"rank\": \"8\"}, \"id\": 3}, {\"action\": \"request\", \"args\": {\"target_player\": 3, \"rank\": \"Q\"}, \"id\": 4}, {\"action\": \"request\", \"args\": {\"target_player\": 3, \"rank\": \"8\"}, \"id\": 5}, {\"action\": \"draw\", \"id\": 6}]}\n\nExplanation: \n{\"common\": \"A dictionary containing common information about the game shared among all players.\", \"common.num_players\": \"The total number of players in the game.\", \"common.current_player\": \"The index of the player whose turn it is currently.\", \"common.winner\": \"The index of the winning player or null if the game is not over yet.\", \"common.is_over\": \"A boolean indicating if the game is over.\", \"common.books\": \"A list where each element represents the number of books completed by each player.\", \"common.facedown_cards.stock_size\": \"The number of cards remaining in the stock pile.\", \"players\": \"A list of dictionaries containing information about each player.\", \"players[i].public.current_player\": \"A boolean indicating whether the player 'i' is the current player.\", \"players[i].facedown_cards.hand\": \"The list of cards currently held by the player 'i', visible only to the player.\", \"players[i].facedown_cards.hand_size\": \"The number of cards in player's 'i' hand, visible to other players but without specific card details.\", \"players[i].faceup_cards.books\": \"A list of completed books by the player 'i', visible to all players.\", \"recent_history\": \"A list of actions, information and turn end logs for tracking the history of recent events and moves in the game.\", \"recent_history[i].type\": \"The type of entry in the recent history: 'action', 'info', or 'turn_end'.\", \"recent_history[i].player_id\": \"The ID of the player associated with the recent history entry, applicable for actions or turn end.\", \"recent_history[i].action\": \"A dictionary detailing the action taken by a player, if the entry type is 'action'.\", \"recent_history[i].msg\": \"A text message providing details about the history entry.\", \"recent_history[i].role\": \"The role or source of the information in the history entry, typically null.\", \"legal_actions\": \"A list of legal actions that the current player can take, including action type and arguments.\", \"legal_actions[i].action\": \"The type of action that can be taken, such as 'request' or 'draw'.\", \"legal_actions[i].args\": \"Additional arguments required for taking the action, if applicable.\", \"legal_actions[i].id\": \"A unique identifier for the action within the legal actions list.\"}",
    "policy_list": [
        "**Potential Book Completion**\nMeasures the likelihood of completing a book based on current hand and previously requested cards. Calculated as the number of cards of a specific rank the player has plus the known whereabouts of other cards of the same rank based on history.",
        "**Opponent Vulnerability Index**\nEvaluates the likelihood an opponent has cards of a needed rank. This is influenced by previous interactions, such as whether the opponent asked for or supplied a card of this rank, and the general flow of cards across players.",
        "**Stock Dependency**\nAssesses the importance or risk of going fishing (drawing from stock) based on the player's current hand composition and stock size. A higher metric value indicates a greater reliance on drawing to complete books because of few opportunities to ask effectively.",
        "**Turn Continuation Probability**\nEstimates the chance of maintaining the turn after asking for a card, which combines the likelihood of making a successful request with the number of potential books that could emerge from a successful card receipt. This metric helps prioritize asking actions to balance book formation and prolonging turns."
    ],
    "code": [
        "\ndef score(state: dict, action: dict) -> float:\n    # Extract key information from the input state\n    num_players = state[\"common\"][\"num_players\"]\n    current_player_index = state[\"common\"][\"current_player\"]\n    player_hand = state[\"players\"][current_player_index][\"facedown_cards\"][\"hand\"]\n    books_completed = state[\"common\"][\"books\"]\n    recent_history = state.get(\"recent_history\", [])  # Use .get() to safely handle the potential absence of the key\n    \n    # Initialize potential book completion probability\n    potential_book_score = 0.0\n    \n    # Extract the rank being requested in the action if it is a 'request' action\n    if action['action'] == 'request':\n        requested_rank = action['args']['rank']\n    else:\n        # If the action is 'draw', return a default baseline score\n        result_score = 0.1  # Low score for drawing from stock as a default conservative action\n        return result_score\n    \n    # Count how many of the requested rank are already in hand\n    count_in_hand = sum(1 for card in player_hand if card['rank'] == requested_rank)\n    \n    # Search recent history to account for known whereabouts of the requested rank\n    known_outside_count = 0\n    for history in recent_history:\n        if history[\"type\"] == \"info\":\n            msg = history[\"msg\"]\n            if 'requests rank ' in msg:\n                # Find the rank requested in each relevant history entry\n                target_rank_location = msg.find('rank ') + len('rank ')\n                history_rank = msg[target_rank_location:target_rank_location+1]\n                if history_rank == requested_rank:\n                    if 'gives' in msg:\n                        # When a player gives card(s), increase the known count\n                        known_outside_count += int(msg.split()[3])\n    \n    # Calculate the potential completion score\n    total_known_rank_count = count_in_hand + known_outside_count\n    \n    # If we have all 4, the book is complete => highest probability of \"success\"\n    if total_known_rank_count >= 4:\n        potential_book_score = 1.0\n    else:\n        # Calculate a proportional score based on the number of known cards\n        potential_book_score = total_known_rank_count / 4.0\n    \n    # Include a factor for current books as it brings us closer to the win\n    total_books = books_completed[current_player_index]\n    book_factor = (total_books / (13 * num_players))\n    \n    # Calculate final score: Combination of potential book completion and current books as a fraction of total 13 possible books\n    result_score = (0.7 * potential_book_score) + (0.3 * book_factor)\n\n    return result_score\n",
        "\ndef score(state: dict, action: dict) -> float:\n    import math\n\n    # Extract necessary information from the state\n    num_players = state['common']['num_players']\n    current_player_idx = state['common']['current_player']\n    stock_size = state['common']['facedown_cards']['stock_size']\n\n    # Initialize recent_history, if not present\n    recent_history = state.get('recent_history', [])\n    player_hand = state['players'][current_player_idx]['facedown_cards']['hand']\n    \n    # Extract action details\n    action_type = action['action']\n    action_args = action.get('args', {})\n\n    # Variables for calculating scores\n    opponent_vulnerability = {}\n    player_books = state['common']['books'][current_player_idx]\n\n    # Calculate the opponent vulnerability index based on recent history\n    for entry in recent_history:\n        if entry['type'] == 'action' and 'request' in entry['action']['action']:\n            action_details = entry['action']['args']\n            target_player = action_details['target_player']\n            requested_rank = action_details['rank']\n\n            if target_player not in opponent_vulnerability:\n                opponent_vulnerability[target_player] = {}\n\n            if requested_rank not in opponent_vulnerability[target_player]:\n                opponent_vulnerability[target_player][requested_rank] = 0\n\n            if entry['msg'].endswith(\"Go Fish!\"):\n                # When a \"Go Fish\" occurs, decrement rank importance (they didn't have it)\n                opponent_vulnerability[target_player][requested_rank] -= 1\n            else:\n                # When they do not \"Go Fish!\", increment rank found (they had it)\n                opponent_vulnerability[target_player][requested_rank] += 1\n\n    # Assess opponent vulnerability based on tracked data\n    if action_type == \"request\":\n        target_player = action_args['target_player']\n        rank = action_args['rank']\n        vulnerability_score = opponent_vulnerability.get(target_player, {}).get(rank, 0)\n\n    elif action_type == \"draw\":\n        # Drawing card should account for stock depletion, reflecting decreased chance to peg books\n        vulnerability_score = -math.sqrt(stock_size) if stock_size != 0 else -1\n\n    else:\n        vulnerability_score = 0\n    \n    # Calculate a basic reward score\n    base_score = 0.5 + (player_books / 13.0)\n\n    # Incorporate adjusted vulnerability score\n    adjusted_score = base_score + (vulnerability_score / num_players / 2)\n\n    # Constrain adjusted_score to the range [0, 1]\n    result_score = max(0, min(1, adjusted_score))\n\n    return result_score\n",
        "\ndef score(state: dict, action_id: int) -> float:\n    # Extract relevant information from the state\n    num_players = state['common']['num_players']\n    current_player_index = state['common']['current_player']\n    stock_size = state['common']['facedown_cards']['stock_size']\n    player_hand = state['players'][current_player_index]['facedown_cards']['hand']\n    player_books = len(state['players'][current_player_index]['faceup_cards']['books'])\n    total_books = sum(state['common']['books'])\n    \n    # Analyze the given action\n    legal_actions = state['legal_actions']\n    action = next((act for act in legal_actions if act['id'] == action_id), None)\n    \n    # If action is not found, return 0 as the score indicating an invalid or non-executable action\n    if action is None:\n        return 0.0\n    \n    # Initialize variables for scoring\n    hand_rank_count = {}\n    for card in player_hand:\n        rank = card['rank']\n        hand_rank_count[rank] = hand_rank_count.get(rank, 0) + 1\n\n    # Stock dependency: determines how reliant the player is on \"fishing\"\n    stock_dependency = 0\n    if action['action'] == 'draw':  # Drawing from stock indicates reliance on unseen cards\n        stock_dependency = max(0, (4 - max(hand_rank_count.values(), default=0))) / 4\n    \n    # Calculate the potential to complete a book with the current action\n    potential_book_completion = 0\n    if action['action'] == 'request':\n        rank_requested = action['args']['rank']\n        hand_count = hand_rank_count.get(rank_requested, 0)\n        # The more cards we have of this rank, the higher the potential to complete a book\n        potential_book_completion = hand_count / 4\n\n    # Normalize the current situation in terms of books\n    books_progress = player_books / (13 / num_players)\n\n    # Weigh the components for an estimated score\n    result_score = (0.5 * potential_book_completion) + (0.3 * (1 - stock_dependency)) + (0.2 * books_progress)\n    \n    # Make sure the result is within the [0, 1] range\n    result_score = max(0, min(1, result_score))\n    \n    return result_score\n",
        "\ndef score(state: dict, action: dict) -> float:\n    current_player_index = state['common']['current_player']\n    current_player_hand = state['players'][current_player_index]['facedown_cards']['hand']\n    \n    if action['action'] == 'request':\n        requested_rank = action['args']['rank']\n        potential_book = sum(1 for card in current_player_hand if card['rank'] == requested_rank)\n        \n        # Base score (probability) factors\n        base_score = potential_book / 4.0  # Attempting to make a book of 4 cards\n        \n        # Influencing factors\n        num_other_players = state['common']['num_players'] - 1\n        opponent_hand_sizes = [player['facedown_cards']['hand_size'] for i, player in enumerate(state['players']) if i != current_player_index]\n        average_opponent_hand_size = sum(opponent_hand_sizes) / num_other_players\n\n        # Weight the score by assessing the state of the game\n        influence_factor = (\n            0.5 * (4 - potential_book) / 4.0 +  # More weight if closer to forming a book\n            0.2 * (state['common']['facedown_cards']['stock_size'] / 52.0) +  # Influence by stock size\n            0.3 * (average_opponent_hand_size / 7.0)  # More benefit if opponents have larger hands\n        )\n        \n        # Calculating final score between [0, 1]\n        result_score = min(max(base_score * influence_factor, 0.0), 1.0)\n        \n    elif action['action'] == 'draw':\n        # For drawing, bets on potential improvement by drawing a new card\n        stock_size = state['common']['facedown_cards']['stock_size']\n        # Assume a neutral draw prospect score\n        result_score = 0.5 * (stock_size / 52.0)\n\n    else:\n        # Default score for any unrecognized action\n        result_score = 0.0\n\n    return result_score\n"
    ]
}